<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Porting from Nuvola Player 2 to Nuvola Player 3</title>
    <link rel="stylesheet" href="../theme/bootstrap.min.css" />
    <link rel="stylesheet" href="../theme/pygments.css" />
    <link rel="stylesheet" href="../theme/main.css" />
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script src="../theme/jquery.min.js"></script>
    <script src="../theme/bootstrap.min.js"></script>
  </head>
  <body>
<nav class="navbar navbar-default navbar-static-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
<a class="navbar-brand" href="../index.html">Nuvola Player Development</a>    </div><!-- .navbar-header -->

<div class="collapse navbar-collapse" id="navbar-collapse-1">
  <ul class="nav navbar-nav">
            <li><a href="../index.html">Home</a></li>
            <li><a href="../core.html">Core</a></li>
            <li class="dropdown">
              <a href="../apps.html" class="dropdown-toggle" data-toggle="dropdown">Service Integrations <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                <li><a href="../apps.html">Introduction</a></li>
                <li><a href="../apps/porting.html">Porting to Nuvola Player 3</a></li>
                <li><a href="../apps/api_reference.html">NuvolaKit 3.0 JavaScript API Reference</a></li>
                <li class="divider"></li>
                <li class="dropdown-header">Basic</li>
                <li><a href="../apps/tutorial.html">Service Integration Tutorial</a></li>
                <li><a href="../apps/guidelines.html">Service Integration Guidelines</a></li>
                <li><a href="../apps/distribute.html">Distribute Service Integration</a></li>
                <li class="divider"></li>
                <li class="dropdown-header">Advanced</li>
                <li><a href="../apps/guide.html">Full Service Integration Guide</a></li>
                <li><a href="../apps/url-filtering.html">URL Filtering (URL Sandbox)</a></li>
                <li><a href="../apps/configuration-and-session-storage.html">Configuration and session storage</a></li>
                <li><a href="../apps/initialization-and-preferences-forms.html">Initialization and Preferences Forms</a></li>
                <li><a href="../apps/variable-home-page-url.html">Web apps with a variable home page URL</a></li>
                <li><a href="../apps/custom-actions.html">Custom Actions</a></li>
              </ul>
            </li>
          </ul>
</div><!-- .navbar-collapse -->  </div>
</nav>    
    <div class="container">
      <div class="row">
        
  <div class="col-sm-12">
      <div class="page-header text-center">
        <h1 id="top">Porting from Nuvola Player 2 to Nuvola Player 3</h1>
      </div>
  </div>
  <div class="col-md-2 col-lg-3 sidebar">
      <p><strong>Contents</strong></p>
      <div class="toc">
<ul>
<li><a href="#prepare-development-environment">Prepare development environment</a></li>
<li><a href="#port-metadata">Port metadata</a></li>
<li><a href="#port-integration-script">Port integration script</a></li>
<li><a href="#port-settings">Port settings</a></li>
<li><a href="#distribute-your-work">Distribute your work</a></li>
</ul>
</div>
<p><strong>Download documentation</strong></p>

<p>You can download the whole documentation in HTML format as</p>
<ul>
  <li><a href="https://github.com/tiliado/nuvolaplayer-developer-doc/archive/master.zip">Zip Archive</a></li>
  <li><a href="https://github.com/tiliado/nuvolaplayer-developer-doc">Git Repository</a></li>
</ul>

<p><strong>Get source</strong></p>
<p>
  This documentation is built from the
  <a href="https://github.com/tiliado/nuvolaplayer/tree/master/doc">doc directory</a>
  of the
  <a href="https://github.com/tiliado/nuvolaplayer">Nuvola Player repository</a>.
</p>    <span class="backtotop"><a href="#top">↑ Back to top ↑</a></span>
  </div>
  <div class="col-sm-12 col-md-10 col-lg-9">
    <p>This guide describes porting of service integrations from Nuvola Player 2 to Nuvola Player 3.</p>
<h2 id="prepare-development-environment">Prepare development environment</h2>
<p>Steps are described in <a href="../apps/tutorial.html">service integrations tutorial</a>.</p>
<h2 id="port-metadata">Port metadata</h2>
<p><strong>Metadata file contains basic information about your service integration.</strong> While Nuvola Player 2
read metadata from a INI-style file <code>metadata.conf</code>, Nuvola Player 3 uses
a <a href="http://en.wikipedia.org/wiki/JSON">JSON file</a> <code>metadata.json</code>.
See <a href="../apps/tutorial.html#create-metadata-file">sample metadata file in tutorial</a>.</p>
<dl>
<dt>Mapping of old <code>metadata.conf</code> fields to the new <code>metadata.json</code> fields:</dt>
<dd>
<ul>
<li><code>id</code> - it can now contain letters a-z, digits 0-9 and dash - to separate words, e.g.
    google-play for Google Play Music, 8tracks for 8tracks.com. The id can differ from the directory
    name of the service integration.</li>
<li><code>name</code> - unchanged</li>
<li><code>version</code> - increase major version number by one</li>
<li><code>version_minor</code> - set minor version number to 0</li>
<li><code>home_page</code> - name changed to <code>home_url</code></li>
<li><code>sandbox_pattern</code> - name changed to <code>allowed_uri</code>, optional field. See the article
    <a href="../apps/url-filtering.html">URL Filtering (URL Sandbox)</a>.</li>
<li><code>maintainer_name</code> - unchanged</li>
<li><code>maintainer_link</code> - if you want to have your service integration shipped with Nuvola
    Player, you must use link to your Github profile. (See
    <a href="../apps/guidelines.html">guidelines</a>.)</li>
<li><code>flash_plugin</code> - no longer used (Flash plugin is currently enabled by default)</li>
<li><code>api_major</code> and <code>api_minor</code> - you have to use API &gt;= 3.0</li>
<li><code>requirements_specified</code> - no longer used</li>
</ul>
</dd>
<dt>The extra <code>metadata.json</code> fields not present in <code>metadata.conf</code></dt>
<dd>
<ul>
<li><code>categories</code>: Application categories suitable for the web app. It is used to place a desktop
    launcher to proper category in applications menu. Nuvola Player services should be in
    "AudioVideo;Audio;".</li>
</ul>
</dd>
</dl>
<h2 id="port-integration-script">Port integration script</h2>
<p>File name of the integration script has changed to <code>integrate.js</code> and the Nuvola Player 3
JavaScript API is completely different. You should
<a href="../apps/tutorial.html#create-integration-script">create a new service integration script from scratch</a>
taking into account following porting notes:</p>
<ul>
<li>
<p>You can reuse code of your <code>update()</code> method dealing with extraction of track details from
    the web page.</p>
</li>
<li>
<p><code>Nuvola.bind()</code> function is gone, because Nuvola Player 3 depends on a young enough WebKitGtk
    library that supports <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind">Function.prototype.bind()</a>.</p>
</li>
<li>
<p>It is necessary to explicitly initialize <a href="./api_reference.html#Nuvola.MediaPlayer">MediaPlayer</a> component:
    <code>var player = Nuvola.$object(Nuvola.MediaPlayer);</code></p>
</li>
<li>
<p>Playback states are in an enumeration <a href="./api_reference.html#Nuvola.PlaybackState">Nuvola.PlaybackState</a>
    instead of constants <code>Nuvola.STATE_NONE/STATE_PAUSED/STATE_PLAYING</code>.</p>
</li>
<li>
<p>The replacements for <code>Nuvola.updateSong()</code> are methods
    <a href="./api_reference.html#Nuvola.MediaPlayer.setPlaybackState">player.setPlaybackState()</a> and
    <a href="./api_reference.html#Nuvola.MediaPlayer.setTrack">player.setTrack()</a>.</p>
</li>
<li>
<p>The replacements for <code>Nuvola.updateAction()</code> are methods
    <a href="./api_reference.html#Nuvola.MediaPlayer.setCanPause">player.setCanPause()</a>,
    <a href="./api_reference.html#Nuvola.MediaPlayer.setCanPlay">player.setCanPlay()</a>,
    <a href="./api_reference.html#Nuvola.MediaPlayer.setCanGoPrev">player.setCanGoPrev()</a> and
    <a href="./api_reference.html#Nuvola.MediaPlayer.setCanGoNext">player.setCanGoNext()</a>.</p>
</li>
<li>
<p>The replacement for <code>Nuvola.onMessageReceived</code> is a signal
    <a href="./api_reference.html#Nuvola.Actions%3A%3AActionActivated">Actions::ActionActivated</a>. Player action
    names are defined in an enumeration <a href="./api_reference.html#Nuvola.PlayerAction">Nuvola.PlayerAction</a>. Tutorial
    describes how to use this new API.</p>
</li>
<li>
<p>Actions <code>Nuvola.ACTION_THUMBS_UP/ACTION_THUMBS_DOWN/ACTION_LOVE</code> are not defined by default,
    but you can create them using custom actions API. <strong>TODO</strong> write docs.</p>
</li>
</ul>
<h2 id="port-settings">Port settings</h2>
<p>While Nuvola Player 2 uses a settings script <code>settings.js</code>, Nuvola Player 3 uses <code>integrate.js</code>
also for settings management. See article
<a href="../apps/initialization-and-preferences-forms.html">Initialization and Preferences Forms</a>
for details how to get user input and manage preferences and article
<a href="../apps/variable-home-page-url.html">Web apps with a variable home page URL</a> for
use cases of Initialization and Preferences Forms to allow user specify a custom home page url.</p>
<h2 id="distribute-your-work">Distribute your work</h2>
<p>While service integrations in Nuvola Player 2 are maintained in the same repository as the Nuvola Player itself,
service integrations for Nuvola Player 3 are more independent and are maintained in separate repositories.
See article <a href="../apps/distribute.html">Distribute Service Integration</a> for details.</p>

<div class="footer">
  <hr />
  <div class="panel panel-primary">
    <p class="panel-heading">
      Questions? Feedback?
    </p>
    <div class="panel-body">
      <p>
        Having trouble? We'd like to help!
      </p>
      <ul>
        <li>Search for information in the archives of
          <a href="https://groups.google.com/d/forum/nuvola-player-devel">the nuvola-player-devel
          mailing list</a>, or post a question.
        </li>
        <li>
          If you notice errors with this documentation, please
          <a href="https://github.com/tiliado/nuvolaplayer/issues">open a ticket and let us
          know</a>! Please only use the ticket tracker for criticisms and improvements on the docs.
        </li>
      </ul>
    </div>
  </div>
  <hr />
  <p class="text-center">
    Generated by <a href="http://getpelican.com/">Pelican</a>.
    Get <a href="https://github.com/tiliado/nuvolaplayer/tree/master/doc">source code</a>.
    Uses <a href="http://getbootstrap.com/">Bootstrap</a> theme
    <a href="http://bootswatch.com/united/">United</a>.
  </p>
</div>  </div> 
      </div>
    </div>
  </body>
</html>
